{"changed":true,"filter":false,"title":"fetcher.js","tooltip":"/src/fetcher.js","value":"var schedule = require('node-schedule');\nvar git = require('./git');\nvar fs = require('fs');\nvar mkpath = require('./mkpath');\n\nconsole.log('git' + git);\n\nfunction Fetcher() {\n  this.git = git;\n  this.init();\n}\n\nFetcher.prototype.init = function() {\n  this.cron = new schedule.RecurrenceRule();\n  this.cron.minute = 1;\n\n  var j = schedule.scheduleJob(this.cron, this.fetch());\n};\n\nFetcher.prototype.fetch = function(options, next) {\n  var path = require('path');\n  \n  // Directory path\n  var d = new Date();\n  var path = './../data'+path.sep+d.getUTCFullYear()+path.sep+d.getUTCMonth()+path.sep+d.getUTCDate()+path.sep;\n  \n  mkpath.sync(path, 0777);\n  \n  this.git.search({}, function(err, repos) {\n    console.log(repos);\n    fs.writeFile(path+'repos.json', JSON.stringify(repos, null, 4), function (err) {\n      if (err) throw err;\n      console.log('It\\'s saved!');\n    });\n    \n    \n    \n  });\n  \n};\n\nvar fetcher = new Fetcher();\nmodule.exports = fetcher;","undoManager":{"mark":99,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":28,"column":26},"end":{"row":28,"column":27},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":42},"end":{"row":28,"column":48},"action":"remove","lines":["myData"]},{"start":{"row":28,"column":42},"end":{"row":28,"column":47},"action":"insert","lines":["repos"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":0},"end":{"row":29,"column":2},"action":"insert","lines":["  "]},{"start":{"row":30,"column":0},"end":{"row":30,"column":2},"action":"insert","lines":["  "]},{"start":{"row":31,"column":0},"end":{"row":31,"column":2},"action":"insert","lines":["  "]},{"start":{"row":32,"column":0},"end":{"row":32,"column":2},"action":"insert","lines":["  "]},{"start":{"row":33,"column":0},"end":{"row":33,"column":2},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":34,"column":0},"end":{"row":34,"column":2},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":34,"column":5},"end":{"row":34,"column":6},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":34,"column":2},"end":{"row":34,"column":4},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":6},"end":{"row":34,"column":5},"action":"remove","lines":["if(err) {","        console.log(err);","      } else {","        console.log(\"JSON saved to \" + outputFilename);","      }","    }"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":0},"end":{"row":29,"column":6},"action":"remove","lines":["      "]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":74},"end":{"row":29,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":73},"end":{"row":28,"column":74},"action":"remove","lines":["{"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":72},"end":{"row":28,"column":73},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":71},"end":{"row":28,"column":72},"action":"remove","lines":[")"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":70},"end":{"row":28,"column":71},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":69},"end":{"row":28,"column":70},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":68},"end":{"row":28,"column":69},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":67},"end":{"row":28,"column":69},"action":"remove","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":66},"end":{"row":28,"column":67},"action":"remove","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":65},"end":{"row":28,"column":66},"action":"remove","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":64},"end":{"row":28,"column":65},"action":"remove","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":63},"end":{"row":28,"column":64},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":62},"end":{"row":28,"column":63},"action":"remove","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":61},"end":{"row":28,"column":62},"action":"remove","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":60},"end":{"row":28,"column":61},"action":"remove","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":59},"end":{"row":28,"column":60},"action":"remove","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":58},"end":{"row":28,"column":59},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":57},"end":{"row":28,"column":58},"action":"remove","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":57},"end":{"row":28,"column":58},"action":"insert","lines":[")"]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":2},"end":{"row":27,"column":0},"action":"insert","lines":["",""]},{"start":{"row":27,"column":0},"end":{"row":27,"column":2},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":27,"column":2},"end":{"row":27,"column":19},"action":"insert","lines":["fs.mkdirSync(path"]}]}],[{"group":"doc","deltas":[{"start":{"row":27,"column":19},"end":{"row":27,"column":20},"action":"insert","lines":[")"]}]}],[{"group":"doc","deltas":[{"start":{"row":27,"column":20},"end":{"row":27,"column":21},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":27,"column":5},"end":{"row":27,"column":14},"action":"remove","lines":["mkdirSync"]},{"start":{"row":27,"column":5},"end":{"row":27,"column":14},"action":"insert","lines":["mkdirSync"]}]}],[{"group":"doc","deltas":[{"start":{"row":25,"column":107},"end":{"row":25,"column":120},"action":"remove","lines":["+'repos.json'"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":25},"end":{"row":29,"column":38},"action":"insert","lines":["+'repos.json'"]}]}],[{"group":"doc","deltas":[{"start":{"row":25,"column":14},"end":{"row":25,"column":15},"action":"remove","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":23},"end":{"row":3,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":0},"end":{"row":3,"column":23},"action":"insert","lines":["var fs = require('fs');"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":18},"end":{"row":3,"column":20},"action":"remove","lines":["fs"]},{"start":{"row":3,"column":18},"end":{"row":3,"column":19},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":19},"end":{"row":3,"column":20},"action":"insert","lines":["k"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":20},"end":{"row":3,"column":21},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":21},"end":{"row":3,"column":22},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":22},"end":{"row":3,"column":23},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":23},"end":{"row":3,"column":24},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":4},"end":{"row":3,"column":6},"action":"remove","lines":["fs"]},{"start":{"row":3,"column":4},"end":{"row":3,"column":10},"action":"insert","lines":["mkpath"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":2},"end":{"row":29,"column":0},"action":"insert","lines":["",""]},{"start":{"row":29,"column":0},"end":{"row":29,"column":2},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":2},"end":{"row":28,"column":40},"action":"insert","lines":["mkpath.sync('/tmp/blue/orange', 0700);"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":2},"end":{"row":29,"column":21},"action":"remove","lines":["fs.mkdirSync(path);"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":14},"end":{"row":28,"column":32},"action":"remove","lines":["'/tmp/blue/orange'"]},{"start":{"row":28,"column":14},"end":{"row":28,"column":15},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":15},"end":{"row":28,"column":16},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":16},"end":{"row":28,"column":17},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":17},"end":{"row":28,"column":18},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":22},"end":{"row":3,"column":23},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":23},"end":{"row":3,"column":24},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":22},"end":{"row":28,"column":24},"action":"remove","lines":["00"]},{"start":{"row":28,"column":22},"end":{"row":28,"column":23},"action":"insert","lines":["7"]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":23},"end":{"row":28,"column":24},"action":"insert","lines":["7"]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":14},"end":{"row":26,"column":15},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":16},"end":{"row":26,"column":17},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":17},"end":{"row":26,"column":18},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":17},"end":{"row":26,"column":18},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":17},"end":{"row":26,"column":18},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":18},"end":{"row":26,"column":19},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":17},"end":{"row":26,"column":18},"action":"remove","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":16},"end":{"row":26,"column":17},"action":"remove","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":15},"end":{"row":26,"column":16},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":14},"end":{"row":26,"column":15},"action":"remove","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":14},"end":{"row":26,"column":15},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":16},"end":{"row":26,"column":17},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":17},"end":{"row":26,"column":18},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":26,"column":18},"end":{"row":26,"column":19},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":2},"end":{"row":9,"column":24},"action":"remove","lines":["console.log(this.git);"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":17},"end":{"row":9,"column":2},"action":"remove","lines":["","  "]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":17},"end":{"row":9,"column":2},"action":"remove","lines":["","  "]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":44},"end":{"row":29,"column":0},"action":"insert","lines":["",""]},{"start":{"row":29,"column":0},"end":{"row":29,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":4},"end":{"row":29,"column":5},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":5},"end":{"row":29,"column":6},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":6},"end":{"row":29,"column":7},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":7},"end":{"row":29,"column":8},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":8},"end":{"row":29,"column":9},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":9},"end":{"row":29,"column":10},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":10},"end":{"row":29,"column":11},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":11},"end":{"row":29,"column":12},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":12},"end":{"row":29,"column":13},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":13},"end":{"row":29,"column":14},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":14},"end":{"row":29,"column":15},"action":"insert","lines":["g"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":15},"end":{"row":29,"column":17},"action":"insert","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":16},"end":{"row":29,"column":17},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":17},"end":{"row":29,"column":18},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":18},"end":{"row":29,"column":19},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":19},"end":{"row":29,"column":20},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":20},"end":{"row":29,"column":21},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":22},"end":{"row":29,"column":23},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":29,"column":23},"end":{"row":30,"column":0},"action":"insert","lines":["",""]},{"start":{"row":30,"column":0},"end":{"row":30,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":30,"column":4},"end":{"row":33,"column":3},"action":"insert","lines":["fs.writeFile('message.txt', 'Hello Node', function (err) {","  if (err) throw err;","  console.log('It\\'s saved!');","});"]}]}],[{"group":"doc","deltas":[{"start":{"row":31,"column":0},"end":{"row":31,"column":2},"action":"insert","lines":["  "]},{"start":{"row":32,"column":0},"end":{"row":32,"column":2},"action":"insert","lines":["  "]},{"start":{"row":33,"column":0},"end":{"row":33,"column":2},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":31,"column":0},"end":{"row":31,"column":2},"action":"insert","lines":["  "]},{"start":{"row":32,"column":0},"end":{"row":32,"column":2},"action":"insert","lines":["  "]},{"start":{"row":33,"column":0},"end":{"row":33,"column":2},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":34,"column":21},"end":{"row":34,"column":38},"action":"remove","lines":["path+'repos.json'"]}]}],[{"group":"doc","deltas":[{"start":{"row":30,"column":17},"end":{"row":30,"column":30},"action":"remove","lines":["'message.txt'"]},{"start":{"row":30,"column":17},"end":{"row":30,"column":34},"action":"insert","lines":["path+'repos.json'"]}]}],[{"group":"doc","deltas":[{"start":{"row":34,"column":23},"end":{"row":34,"column":53},"action":"remove","lines":["JSON.stringify(repos, null, 4)"]}]}],[{"group":"doc","deltas":[{"start":{"row":30,"column":36},"end":{"row":30,"column":48},"action":"remove","lines":["'Hello Node'"]},{"start":{"row":30,"column":36},"end":{"row":30,"column":66},"action":"insert","lines":["JSON.stringify(repos, null, 4)"]}]}],[{"group":"doc","deltas":[{"start":{"row":34,"column":4},"end":{"row":34,"column":25},"action":"remove","lines":["fs.writeFileSync(, );"]}]}],[{"group":"doc","deltas":[{"start":{"row":34,"column":4},"end":{"row":35,"column":0},"action":"insert","lines":["",""]},{"start":{"row":35,"column":0},"end":{"row":35,"column":4},"action":"insert","lines":["    "]}]}]]},"ace":{"folds":[],"customSyntax":"javascript","scrolltop":120,"scrollleft":0,"selection":{"start":{"row":30,"column":41},"end":{"row":30,"column":50},"isBackwards":false},"options":{"tabSize":2,"useSoftTabs":true,"guessTabSize":false,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":7,"state":"start","mode":"ace/mode/javascript"}}}